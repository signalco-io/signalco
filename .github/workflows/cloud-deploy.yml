# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json

name: "[Infra] Deploy"

on:
  push:
    branches: [main, next]
    paths:
      - "cloud/**"
      - "infra/**"
      - ".github/workflows/cloud-deploy.yml"

jobs:
  infra_cloud-primary_up:
    name: "Cloud Primary infrastructure (deploy)"
    uses: ./.github/workflows/infra-deploy_reusable.yml
    if: success() && github.event_name == 'pull_request'
    with:
      project: "cloud-primary"
      baseRef: ${{ github.base_ref }}
      command: "up"
    secrets: inherit

  infra_uier_up:
    name: "uier infrastructure (deploy)"
    uses: ./.github/workflows/infra-deploy_reusable.yml
    if: success() && github.event_name == 'pull_request'
    with:
      project: "uier"
      baseRef: ${{ github.base_ref }}
      command: "up"
    secrets: inherit